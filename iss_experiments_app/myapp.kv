#:import dp kivy.metrics.dp

# Define a custom CircularButton
<CircularButton@Button>:
    size_hint: None, None
    size: dp(15), dp(15)  # Must be square to produce a perfect circle
    background_normal: ''  # Remove default background image
    background_down: ''    # Remove default background when pressed
    background_color: 0, 0, 0, 0  # Fully transparent
    font_size: 0  # Remove any text

    # Define the circular shape and styling using canvas
    canvas.before:
        Color:
            rgba: 0.5, 0.7, 1, 0.8  # Light blue interior
        Ellipse:
            pos: self.pos
            size: self.size
            angle_start: 0
            angle_end: 360

        Color:
            rgba: 1, 1, 1, 1  # White outline
        Line:
            width: 2
            ellipse: (self.x, self.y, self.width, self.height, 0, 360)

<SplashScreen>:
    RelativeLayout:
        Image:
            source: "assets/images/iss_ram_view.jpg"
            allow_stretch: False
            keep_ratio: True
            size: self.parent.size
            pos: self.parent.pos

        MDLabel:
            text: "Welcome to ISS Experiments App"
            halign: "center"
            font_style: "H4"
            size_hint_y: None
            height: self.texture_size[1]
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            color: 1, 1, 1, 1  # White text for visibility

<DashboardScreen>:
    RelativeLayout:
        Image:
            source: "assets/images/transparent_ISS.png"
            allow_stretch: False
            keep_ratio: True
            size_hint: 1, 0.8  # Occupies 80% of the vertical space
            pos_hint: {"x":0, "y":0.2}

        FloatLayout:
            id: dashboard_buttons
            size_hint: 1, 0.8
            pos_hint: {"x":0, "y":0.2}
            # Experiment buttons will be dynamically added here as CircularButtons

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.2  # Occupies the bottom 20% of the screen
            pos_hint: {"x":0, "y":0}
            padding: dp(10)
            spacing: dp(10)

            MDRaisedButton:
                text: "Home"
                size_hint: None, None
                size: dp(100), dp(50)
                on_release: app.root.current = 'dashboard'

            MDRaisedButton:
                text: "Settings"
                size_hint: None, None
                size: dp(100), dp(50)
                on_release: print("Settings Button Pressed")
                # You can bind this to a settings screen if defined

<QuizScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(20)

        MDLabel:
            text: root.question
            font_style: "H5"
            halign: "center"

        MDBoxLayout:
            orientation: 'vertical'
            spacing: dp(10)
            padding: dp(10)

            MDRaisedButton:
                text: root.options[0]
                on_release: root.check_answer(self.text)
            MDRaisedButton:
                text: root.options[1]
                on_release: root.check_answer(self.text)
            MDRaisedButton:
                text: root.options[2]
                on_release: root.check_answer(self.text)
            MDRaisedButton:
                text: root.options[3]
                on_release: root.check_answer(self.text)

        MDLabel:
            id: feedback
            text: ""
            halign: 'center'
            theme_text_color: 'Secondary'

        MDRaisedButton:
            text: "Back to Dashboard"
            pos_hint: {"center_x": 0.5}
            on_release: root.go_back_to_dashboard()

<ExperimentScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        padding: dp(20)

        MDLabel:
            text: root.title
            font_style: "H5"
            halign: "center"
            size_hint_y: None
            height: self.texture_size[1]

        MDBoxLayout:
            orientation: 'horizontal'
            spacing: dp(20)

            ScrollView:
                MDLabel:
                    text: root.content
                    size_hint_x: 0.7
                    valign: 'top'
                    text_size: self.width, None
                    padding: dp(10), dp(10)

            Image:
                source: root.image_source
                size_hint_x: 0.3
                allow_stretch: False
                keep_ratio: True

        MDRaisedButton:
            text: "Back to Dashboard"
            pos_hint: {"center_x": 0.5}
            size_hint_y: None
            height: dp(50)
            on_release: root.go_back_to_dashboard()